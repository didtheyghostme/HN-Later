(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function o(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(n){if(n.ep)return;n.ep=!0;const s=o(n);fetch(n.href,s)}})();try{}catch(e){console.error("[wxt] Failed to initialize plugins",e)}const f=globalThis.browser?.runtime?.id?globalThis.browser:globalThis.chrome,c=f,i=document.getElementById("list"),h=document.getElementById("empty"),y=document.getElementById("export-btn"),u=document.getElementById("import-input");async function g(){const e=await c.runtime.sendMessage({type:"GET_ITEMS"});if(!e.success)throw new Error(e.error);return e.items}async function w(e){const t=await c.runtime.sendMessage({type:"REMOVE_ITEM",storyId:e});if(!t.success)throw new Error(t.error)}async function b(){const e=await c.runtime.sendMessage({type:"EXPORT_DATA"});if(!e.success)throw new Error(e.error);return e.data}async function E(e){const t=await c.runtime.sendMessage({type:"IMPORT_DATA",json:e});if(!t.success)throw new Error(t.error);return t.count}function d(e){const t=Math.floor((Date.now()-e)/1e3);if(t<60)return"just now";const o=Math.floor(t/60);if(o<60)return`${o}m ago`;const r=Math.floor(o/60);return r<24?`${r}h ago`:`${Math.floor(r/24)}d ago`}function v(e){return e.checkpointCommentId&&e.checkpointTimestamp?`ðŸ“ ${d(e.checkpointTimestamp)}`:"Not started"}function T(e){const t=v(e),o=document.createElement("div");return o.className="story-item",o.innerHTML=`
    <div class="story-title">
      <a href="${e.url}" target="_blank" title="${e.title}">${e.title}</a>
    </div>
    <div class="story-meta">
      <span class="checkpoint-status">${t}</span>
      <span class="comment-count">${e.totalComments} comments</span>
      <span>${d(e.savedAt)}</span>
    </div>
    <div class="story-actions">
      <button class="btn btn-primary continue-btn" data-url="${e.hnUrl}">
        â–¶ Continue
      </button>
      <button class="btn btn-secondary remove-btn" data-id="${e.id}">
        âœ• Remove
      </button>
    </div>
  `,o.querySelector(".continue-btn").addEventListener("click",r=>{const n=r.currentTarget.dataset.url;c.runtime.sendMessage({type:"OPEN_THREAD",url:n}),window.close()}),o.querySelector(".remove-btn").addEventListener("click",async r=>{const n=r.currentTarget.dataset.id;await w(n),o.remove(),m()}),o}function m(){const e=i.children.length>0;i.hidden=!e,h.hidden=e}async function p(){const e=await g();i.innerHTML="";for(const t of e)i.appendChild(T(t));m()}function a(e){let t=document.querySelector(".toast");t||(t=document.createElement("div"),t.className="toast",document.body.appendChild(t)),t.textContent=e,t.classList.add("show"),setTimeout(()=>t?.classList.remove("show"),2e3)}y.addEventListener("click",async()=>{try{const e=await b(),t=new Blob([e],{type:"application/json"}),o=URL.createObjectURL(t),r=document.createElement("a");r.href=o,r.download=`hn-later-backup-${new Date().toISOString().split("T")[0]}.json`,r.click(),URL.revokeObjectURL(o),a("Data exported!")}catch(e){a("Export failed"),console.error(e)}});u.addEventListener("change",async e=>{const t=e.target.files?.[0];if(t){try{const o=await t.text(),r=await E(o);await p(),a(`Imported ${r} stories!`)}catch(o){a("Import failed - invalid file"),console.error(o)}u.value=""}});p();
